<!DOCTYPE html>
<html>
<head>
    <title>Your Cart</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f5f5f5; margin: 0; padding: 0; }
        .cart-container {
            width: 60%; margin: 30px auto; background: white; padding: 20px;
            border-radius: 10px; box-shadow: 0px 0px 10px #ccc;
        }
        h2 { text-align: center; color: #333; }
        .cart-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 0; border-bottom: 1px solid #ddd;
        }
        .cart-item img {
            width: 50px; height: 50px; object-fit: cover; border-radius: 5px;
            margin-right: 10px; border: 1px solid #ccc;
        }
        .item-info { display: flex; align-items: center; }
        
        /* Buttons */
        .delete-btn {
            background: #ff4d4d; color: white; border: none; padding: 5px 8px;
            cursor: pointer; border-radius: 4px; transition: 0.3s;
        }
        .delete-btn:hover { background: #cc0000; }
        
        .place-order {
            background: #28a745; color: white; border: none; padding: 10px 15px;
            font-size: 16px; border-radius: 5px; cursor: pointer; margin-top: 10px;
        }
        .place-order:hover { background: #218838; }
        
        .back-btn {
            background: #007bff; color: white; border: none; padding: 10px 15px;
            font-size: 16px; border-radius: 5px; cursor: pointer; margin-top: 10px;
            margin-right: 10px;
        }
        .back-btn:hover { background: #0056b3; }
        
        .total { font-weight: bold; font-size: 18px; margin-top: 10px; }
        
        .buttons-container {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
    </style>
</head>
<body>

<div class="cart-container">
    <h2>Your Cart</h2>
    <div id="cart-items"></div>
    <div class="total" id="total-price">Total: â‚¹0</div>
    <div class="buttons-container">
        <button class="back-btn" onclick="goBack()">â¬… Back to Shop</button>
        <button class="place-order" onclick="placeOrder()">Place Order</button>
    </div>
</div>

<script>
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    const productImages = {
        "Arduino Uno R3": "Arduino.jpg.jpg",
        "Raspberry Pi 0": "RaspberryPi.jpg",
        "Resisters (1k), 100 pcs": "Resistors.jpg",
        "ESP8266 WiFi Module": "esp.png"
    };

    function renderCart() {
        let cartItemsDiv = document.getElementById("cart-items");
        let totalPrice = 0;
        cartItemsDiv.innerHTML = "";

        cart.forEach((item, index) => {
            let itemDiv = document.createElement("div");
            itemDiv.classList.add("cart-item");

            let infoDiv = document.createElement("div");
            infoDiv.classList.add("item-info");

            let img = document.createElement("img");
            img.src = productImages[item.name] || "default.jpg";

            let name = document.createElement("span");
            name.textContent = `${item.name} (x${item.quantity})`;

            infoDiv.appendChild(img);
            infoDiv.appendChild(name);

            let price = document.createElement("span");
            price.textContent = `â‚¹${item.price * item.quantity}`;
            totalPrice += item.price * item.quantity;

            let delBtn = document.createElement("button");
            delBtn.textContent = "Delete";
            delBtn.classList.add("delete-btn");
            delBtn.onclick = () => {
                cart.splice(index, 1);
                localStorage.setItem("cart", JSON.stringify(cart));
                renderCart();
            };

            itemDiv.appendChild(infoDiv);
            itemDiv.appendChild(price);
            itemDiv.appendChild(delBtn);
            cartItemsDiv.appendChild(itemDiv);
        });

        document.getElementById("total-price").textContent = `Total: â‚¹${totalPrice}`;
        return totalPrice;
    }

    function sendWhatsAppOrder(totalAmount) {
        let phoneNumber = "919899490935";
        let message = "ðŸ“¦ *New Order Received!*\n\n";
        message += "ðŸ› *Order Details:*\n";

        cart.forEach(item => {
            message += `â€¢ ${item.name}  â€”  x${item.quantity}  â€”  â‚¹${item.price * item.quantity}\n`;
        });

        message += `\nðŸ’° *Total Amount:* â‚¹${totalAmount}`;
        message += `\n\nðŸ“… Date: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`;
        message += "\n\nâœ… Please confirm the order.";

        let whatsappLink = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
        window.open(whatsappLink, "_blank");
    }

    function placeOrder() {
        let totalAmount = renderCart();
        if (totalAmount > 0) {
            sendWhatsAppOrder(totalAmount);

            let thankYou = document.createElement("h3");
            thankYou.style.textAlign = "center";
            thankYou.style.marginTop = "20px";
            thankYou.style.color = "green";
            thankYou.textContent = "Thank You for Shopping!";
            document.querySelector(".cart-container").appendChild(thankYou);
        } else {
            alert("Your cart is empty!");
        }
    }

    function goBack() {
        window.location.href = "https://digivoltlab-lab.github.io/Digivolt/";
    }

    renderCart();
</script>

</body>
</html>
