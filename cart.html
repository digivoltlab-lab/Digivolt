<!DOCTYPE html>
<html>
<head>
    <title>Your Cart</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f5f5f5; }
        .cart-container {
            width: 80%; margin: 30px auto; background: white; padding: 20px;
            border-radius: 10px; box-shadow: 0px 0px 10px #ccc;
        }
        h2 { text-align: center; }
        table {
            width: 100%; border-collapse: collapse; margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd; padding: 10px; text-align: center;
        }
        th {
            background-color: #007bff; color: white;
        }
        img {
            width: 60px; height: auto;
        }
        .qty-btn {
            padding: 5px 10px; margin: 0 5px; border: none; background: #007bff; color: white; cursor: pointer;
            border-radius: 4px;
        }
        .qty-btn:hover {
            background: #0056b3;
        }
        .total { font-weight: bold; font-size: 18px; margin-top: 10px; text-align: right; }
        .place-order {
            background: green; color: white; border: none; padding: 12px 20px;
            font-size: 16px; border-radius: 5px; cursor: pointer; margin-top: 10px; display: block; width: 100%;
        }
    </style>
</head>
<body>

<div class="cart-container">
    <h2>Your Cart</h2>
    <table>
        <thead>
            <tr>
                <th>Image</th>
                <th>Product</th>
                <th>Qty</th>
                <th>Price (1 pc)</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody id="cart-items"></tbody>
    </table>
    <div class="total" id="total-price">Total: â‚¹0</div>
    <button class="place-order" onclick="placeOrder()">Place Order</button>
</div>

<script>
    // Product images mapping
    const productImages = {
        "Arduino Uno R3": "Arduino.jpg.jpg",
        "Raspberry Pi 4": "RaspberryPi.jpg"
    };

    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    function renderCart() {
        let cartItemsDiv = document.getElementById("cart-items");
        let totalPrice = 0;
        cartItemsDiv.innerHTML = "";

        cart.forEach((item, index) => {
            let row = document.createElement("tr");

            // Image cell
            let imgCell = document.createElement("td");
            let img = document.createElement("img");
            img.src = productImages[item.name] || "placeholder.jpg";
            img.alt = item.name;
            imgCell.appendChild(img);

            // Product name
            let nameCell = document.createElement("td");
            nameCell.textContent = item.name;

            // Quantity with buttons
            let qtyCell = document.createElement("td");
            let minusBtn = document.createElement("button");
            minusBtn.textContent = "-";
            minusBtn.className = "qty-btn";
            minusBtn.onclick = () => changeQuantity(index, -1);

            let qtyText = document.createElement("span");
            qtyText.textContent = item.quantity;

            let plusBtn = document.createElement("button");
            plusBtn.textContent = "+";
            plusBtn.className = "qty-btn";
            plusBtn.onclick = () => changeQuantity(index, 1);

            qtyCell.appendChild(minusBtn);
            qtyCell.appendChild(qtyText);
            qtyCell.appendChild(plusBtn);

            // Price (single unit)
            let priceCell = document.createElement("td");
            priceCell.textContent = `â‚¹${item.price}`;

            // Total price for that item
            let totalCell = document.createElement("td");
            let itemTotal = item.price * item.quantity;
            totalCell.textContent = `â‚¹${itemTotal}`;
            totalPrice += itemTotal;

            // Append all cells
            row.appendChild(imgCell);
            row.appendChild(nameCell);
            row.appendChild(qtyCell);
            row.appendChild(priceCell);
            row.appendChild(totalCell);

            cartItemsDiv.appendChild(row);
        });

        document.getElementById("total-price").textContent = `Total: â‚¹${totalPrice}`;
        return totalPrice;
    }

    function changeQuantity(index, change) {
        cart[index].quantity += change;
        if (cart[index].quantity < 1) cart[index].quantity = 1;
        localStorage.setItem("cart", JSON.stringify(cart));
        renderCart();
    }

    function sendWhatsAppOrder(totalAmount) {
        let phoneNumber = "919899490935";
        let message = "ðŸ“¦ *New Order Received!*\n\n";
        message += "ðŸ› *Order Details:*\n";

        cart.forEach(item => {
            message += `â€¢ ${item.name} â€” x${item.quantity} â€” â‚¹${item.price * item.quantity}\n`;
        });

        message += `\nðŸ’° *Total Amount:* â‚¹${totalAmount}`;
        message += `\nðŸ“… Date: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`;
        message += "\n\nâœ… Please confirm the order.";

        let whatsappLink = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
        window.open(whatsappLink, "_blank");
    }

    function placeOrder() {
        let totalAmount = renderCart();
        if (totalAmount > 0) {
            sendWhatsAppOrder(totalAmount);
        } else {
            alert("Your cart is empty!");
        }
    }

    renderCart();
</script>

</body>
</html>
